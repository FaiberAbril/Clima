<!DOCTYPE html>
<html>

<head>
    <title>Weather App</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="estilos.css">
    <style>
        #map {
            height: 400px;
        }
    </style>
</head>

<body  >

    <div class="container-fluid">
        <div class="row text-center">
            <h1>Weather App Explora el Mapa</h2>
            <p>En la parte central de la página, verás un mapa interactivo. Puedes explorar diferentes lugares en el mapa haciendo clic en cualquier punto. Cuando hagas clic en un lugar, la aplicación mostrará información meteorológica actualizada para esa ubicación.</p>     
        </div>
    </div>
    
<div class="container-fluid">
    <div class="row">
        <div class=" col-sm-12 col-lg-8">
            <div id="map"></div>
        </div>
        <div class="col-sm-12 col-lg-4">
            <div id="weather-info">
                <div class="container">
                    <div class="card">
                        <div class="card-body">
                            <h1 class="card-title" id="lugar" style=""></h1>
                            <h1 class="card-subtitle mb-2 text-muted" id="temperature"></h1>
                            <h2 class="card-text" id="descripcion"></h2>
                            <h2 class="card-text" id="position"></h2>
                            <h2 class="card-text" id="wind-speed"></h2>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

  

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Configuración inicial del mapa en Bucaramanga, Colombia
        var initialCoordinates = [7.1173, -73.1276];
        var initialZoom = 13;
        var mymap = L.map('map').setView(initialCoordinates, initialZoom);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(mymap);

        var marker;

        // Función para obtener datos de clima y mostrarlos
        function getWeatherData(lat, lon) {
            // Reemplaza 'TU_API_KEY' con tu propia clave de API de OpenWeatherMap
            var apiKey = '4090239d69cdb3874de692fd18539299';
            var apiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    var weatherDescription = data.weather[0].description;
                    var temperature = data.main.temp;
                    var cityName = data.name;
                    var  humidity = data.main.humidity;
                    var pressure = data.main.pressure;

                    document.getElementById('lugar').textContent = `${cityName}`;
                    document.getElementById('temperature').textContent = `${temperature}°C`;
                    document.getElementById('position').textContent = `Latitud: ${lat}, Longitud: ${lon}`;
                    document.getElementById('wind-speed').textContent = `${data.wind.speed} m/s`;
                    document.getElementById('humidity').textContent = `${humidity}%`;
                    document.getElementById('descripcion').textContent = `${weatherDescription}`;                
                });
        }

        // Manejador de eventos al hacer clic en el mapa
        mymap.on('click', function (e) {
            if (marker) {
                mymap.removeLayer(marker);
            }
            marker = L.marker(e.latlng).addTo(mymap);

            // Obtener coordenadas
            var lat = e.latlng.lat;
            var lon = e.latlng.lng;

            // Obtener datos de clima y mostrarlos
            getWeatherData(lat, lon);
        });


         // Manejador de eventos al cargar el mapa
         mymap.on('load', function () {

            
            var lat = 7.1173;
            var lon = -73.1276;

            getWeatherData(lat, lon);
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>

</html>
